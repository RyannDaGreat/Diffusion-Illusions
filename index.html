<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<title>Diffusion Illusions: Hiding Images in Plain Sight</title>

	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Century+Gothic|Open+Sans">
	<!-- <link rel="stylesheet" href="dracula.css"> -->


	<style>
		/* Gist Dark Mode Start */

		/* https://github.com/lonekorean/gist-syntax-themes */
		@import url('https://cdn.rawgit.com/lonekorean/gist-syntax-themes/d49b91b3/stylesheets/cobalt.css');
		@import url('https://fonts.googleapis.com/css?family=Open+Sans');

		body .gist .gist-file {
			border-color: #555 #555 #444
		}

		body .gist .gist-data {
			border-color: #555
		}


		.generic_pause_button,
		.reset-all-flip-images-button,
		.reset-all-hidden-characters-button,
		.reset-all-rotaters-button {
			background-color: rgba(248, 248, 242, .2);
			border-radius: 100px;
			/* margin-left: 50%;/ */
			/* margin-right: 50%; */
			padding-left: 10pt;
			padding-right: 10pt;
			cursor: pointer;
			/* text-justify: center;
			text-align: center;
			justify-content: center; */


			-webkit-user-select: none;
			/* Safari */
			-ms-user-select: none;
			/* IE 10 and IE 11 */
			user-select: none;
			/* Standard syntax */
		}

		b {

			/* font-size: 48px; */
			font-weight: bold;
			text-shadow: 0 0 20px rgba(255, 255, 255, 0.3),
				0 0 3px rgba(255, 77, 166, 0.3),
				0 0 4px rgba(255, 77, 166, 0.3),
				0 0 5px rgba(255, 77, 166, 0.3),
				0 0 6px rgba(255, 77, 166, 0.3),
				0 0 7px rgba(255, 77, 166, 0.3),
				0 0 8px rgba(255, 77, 166, 0.3);
		}

		body .gist .gist-meta {
			color: #ffffff;
			background: #373737;
		}

		body .gist .gist-meta a {
			color: #ffffff
		}

		body .gist .gist-data .pl-s .pl-s1 {
			color: #a5c261
		}

		.gist {
			-webkit-box-shadow: 0px 0px 50px 3px rgba(46, 140, 255, 0.56);
			-moz-box-shadow: 0px 0px 50px 3px rgba(46, 140, 255, 0.56);
			box-shadow: 0px 0px 50px 3px rgba(46, 140, 255, 0.56);
		}

		/* Gist Dark Mode End */

		html,
		body {
			background-image: linear-gradient(to top, #181636 0%, #09203f 33%, #162036 66%, rgba(40, 42, 54, 1) 100%);
		}

		body * {
			color: rgba(248, 248, 242, 1);
		}

		a,
		a * {
			color: rgba(80, 250, 123, 1);
			background-color: transparent;
		}

		@font-face {
			font-family: "Didact Gothic";
			src: url("fonts/DidactGothic-Regular.ttf");
		}

		@font-face {
			font-family: "Mukta";
			src: url("fonts/MuktaMalar-Light.ttf");
		}

		/* Apply font to various page elements */
		h1 {
			font-size: 35pt
		}



		h1,
		h2,
		h3,
		h4 {
			font-family: 'Didact Gothic', sans-serif;
			text-align: center;
			color: rgba(255, 184, 108, 1);
		}

		h2 {
			font-size: 28pt;
		}

		h3 {
			font-size: 20pt;
		}

		h1 {
			color: rgb(255, 212, 165);
			font-family:
		}


		/* p, li, and other text elements will inherit the font-family from the body */
		body {
			font-family: 'Mukta', sans-serif;
			margin: 0 15%;
		}

		p {
			font-size: large;
		}

		/* Image styles */
		.images {
			display: flex;
			flex-wrap: wrap;
			justify-content: center;
			width: 90vw;
			margin: 0 auto;
		}


		.flip_image {
			-webkit-user-drag: none;
			user-select: none;
			-webkit-user-drag: none;
			-webkit-user-select: none;
			-moz-user-drag: none;
			-moz-user-select: none;
			-ms-user-drag: none;
			-ms-user-select: none;
			flex: 1;
			max-width: 30vw;
			max-height: 30vh;
			margin: 1vh;
			object-fit: cover;
			width: 256px;
			height: 256px;
			cursor: grab;
			animation: none;
		}

		.flip_image_animated {
			animation: flip 12s linear infinite;
			/* animation-play-state: paused; */
		}



		/* Flip animation */
		@keyframes flip {
			100% {
				transform: rotateZ(360deg);
			}

			87.5%,
			50% {
				transform: rotateZ(180deg);
			}

			37.5%,
			0% {
				transform: rotateZ(0deg);
			}
		}

		.row {
			display: flex;
			flex-wrap: nowrap;
			justify-content: center;
			flex-direction: row;
		}

		.col {
			display: flex;
			flex-wrap: nowrap;
			justify-content: center;
			flex-direction: column;
		}

		.caption {
			text-align: center;
			font-size: 1.2em;
			font-weight: bold;
			margin-top: 5px;
			background-color: transparent;
		}

		.rot_image_size {
			width: 256px;
			height: 256px;
		}

		.rot-image-container {
			display: inline-block;
			/* position: -webkit-sticky; */
			/* position: sticky; */
			position: relative;
			filter: brightness(300%);
			/* height:256px; */
			/* width: 256px; */
			/* z-index: 9999; */
		}

		.hidden-character-image-container {
			display: inline-block;
			position: relative;
			margin: 0;
			border: 0;
			height: 256px;
			width: 256px;
		}

		.quad-rotating-image {
			position: absolute;
			top: 0;
			left: 0;
			/* animation: quad_rotate 12s linear infinite; */
			mix-blend-mode: multiply;
			/* animation-play-state: paused; */
		}

		.season-rotating-image {
			position: absolute;
			top: 0;
			left: 0;
			/* animation: season_rotate 6s linear infinite; */
			mix-blend-mode: multiply;
		}

		/* Add smooth scrolling to all links */
		a {
			scroll-behavior: smooth;
			transition: scroll-behavior 4s;
		}


		.skelly-rotating-image {
			position: absolute;
			top: 0;
			left: 0;
			/* animation: skelly_rotate 9s linear infinite; */
			mix-blend-mode: multiply;
		}

		.center_text {
			text-align: center;
		}


		.elf-rotating-image {
			position: absolute;
			top: 0;
			left: 0;
			animation: elf_rotate 9s linear infinite;
			mix-blend-mode: multiply;
		}

		.quad-overlay {
			mix-blend-mode: multiply;
			filter: brightness(100%);
		}

		.quad-rotating-animation {
			animation: quad_rotate 12s linear infinite;
		}


		@keyframes quad_rotate {
			0% {
				transform: rotateZ(0deg);
			}

			12.5%,
			25% {
				transform: rotateZ(90deg);
			}

			37.5%,
			50% {
				transform: rotateZ(180deg);
			}

			62.5%,
			75% {
				transform: rotateZ(270deg);
			}

			87.5%,
			100% {
				transform: rotateZ(360deg);
			}
		}

		.paused {
			animation-play-state: paused;
		}

		@keyframes season_rotate {
			0% {
				transform: rotateZ(0deg);
			}

			25%,
			50% {
				transform: rotateZ(-90deg);
			}


			75%,
			100% {
				transform: rotateZ(0deg);
			}
		}

		.draggable-image {
			cursor: -webkit-grab;
			cursor: grab;
			user-select: none;
		}

		@keyframes skelly_rotate {
			0% {
				transform: rotateZ(0deg);
			}

			16.666%,
			33.333% {
				transform: rotateZ(180deg);
			}


			50%,
			66.6666% {
				transform: rotateZ(270deg);
			}

			83.3333%,
			100% {
				transform: rotateZ(360deg);
			}
		}

		.inactive_button {
			cursor: default;
			opacity: 0.5;
		}



		@keyframes elf_rotate {
			0% {
				transform: rotateZ(0deg);
			}

			16.666%,
			33.333% {
				transform: rotateZ(90deg);
			}


			50%,
			66.6666% {
				transform: rotateZ(180deg);
			}

			83.3333%,
			100% {
				transform: rotateZ(360deg);
			}
		}

		.draggable-image {
			cursor: -webkit-grab;
			cursor: grab;
			user-select: none;
		}

		@keyframes wiggle {
			25% {
				transform: translateY(10px) rotate(1deg);
			}


			30% {
				transform: rotate(-1deg);
			}

			50% {
				transform: translateY(-10px);
			}

			60% {
				transform: rotate(1deg);
			}

			75% {
				transform: translateY(5px) rotate(0deg);
			}
		}

		.ui-draggable-dragging {
			cursor: -webkit-grabbing;
			cursor: grabbing;
		}

		.glow-hover-element {
			transition: box-shadow 0.1s ease-in-out;
		}

		.glow-hover-element {
			--shadow-opacity: .4;
			/* Opacity value ranging from 0 to 1 */
			--shadow-size: 15px;
			/* Base size of the shadow */
			--shadow-saturation: 400%;
			/* Saturation value ranging from 0% to 100% */
		}

		.glow-hover-element:hover {
			box-shadow:
				0 0 calc(var(--shadow-size) * 1) hsla(0, 0%, 100%, var(--shadow-opacity)),
				0 0 calc(var(--shadow-size) * 1.5) hsla(330, var(--shadow-saturation), 62%, var(--shadow-opacity)),
				0 0 calc(var(--shadow-size) * 2) hsla(330, var(--shadow-saturation), 62%, var(--shadow-opacity)),
				0 0 calc(var(--shadow-size) * 2.5) hsla(330, var(--shadow-saturation), 62%, var(--shadow-opacity)),
				0 0 calc(var(--shadow-size) * 3) hsla(330, var(--shadow-saturation), 62%, var(--shadow-opacity)),
				0 0 calc(var(--shadow-size) * 3.5) hsla(330, var(--shadow-saturation), 62%, var(--shadow-opacity)),
				0 0 calc(var(--shadow-size) * 4) hsla(330, var(--shadow-saturation), 62%, var(--shadow-opacity));
		}

		.lightbox {
			background-color: white !important;
			/* width: 100vw; */
			/* position: absolute; */
			/* left: 0%; */
			/* border: 200px; */
			border-radius: 20px;

			max-width: 100%;
			-webkit-box-shadow: 0px 0px 51px 5px rgba(255, 255, 255, 0.62);
			-moz-box-shadow: 0px 0px 51px 5px rgba(255, 255, 255, 0.62);
			box-shadow: 0px 0px 51px 5px rgba(255, 255, 255, 0.62);
		}

		hr {
			border: none;
			border-top: 3px solid rgba(255, 255, 255, 0.49);
			border-radius: 50px;
			margin: 40px 0;
			margin-top: 100px;
		}

		.smaller-text {
			font-size: 0.8em;
			background-color: transparent;
		}
	</style>
</head>

<body>
	<h1>Diffusion Illusions: Hiding Images in Plain Sight</h1>

	<h4>By <a target="_blank" href="https://ryanndagreat.github.io/">Ryan Burgert</a>,
		<a target="_blank" href="https://scholar.google.com/citations?user=K2WBZTwAAAAJ">Kanchana Ranasinghe</a>,
		<a target="_blank" href="https://scholar.google.com/citations?user=qkyC7KQAAAAJ&hl=en">Xiang Li</a>,
		<a target="_blank" href="https://scholar.google.com/citations?user=vcw0TJIAAAAJ&hl=en">Michael Ryoo</a>
	</h4>


	<h3>Introduction</h3>
	<p>We're excited to share our demo, "Diffusion Illusions: Hiding Images in Plain Sight," which showcases how optical
		illusions and steganography can be created using text-to-image diffusion models.
		<!-- The demo is available at <a -->
		<!-- href="https://ryanndagreat.github.io/Diffusion-Illusions/">ryanndagreat.github.io/Diffusion-Illusions</a> -->
		A video
		demonstration is coming soon! Our demo shows how Score Distillation Loss, introduced in DreamFusion,
		can be used for more than just creating 3D models. For example, as shown in our paper <a
			href="https://ryanndagreat.github.io/peekaboo/">"Peekaboo: Text to Image Diffusion
			Models are Zero Shot Segmentors"</a>, that loss can even be adapted for segmentation. In this
		demo, we use a variant of score distillation loss to optimize different optical illusions - hiding images in
		plain sight.
	</p>
	<p>Source code: <a
			href="https://github.com/RyannDaGreat/Diffusion-Illusions">github.com/RyannDaGreat/Diffusion-Illusions</a>.
		If you like it, please give it a star!</p>
	<p>We'll keep this brief so we can dive right into the pictures - <a class="scroll-to" href="#summary">check the
			bottom of the
			page</a> for more details about this project!</p>
	<p>There are three kinds of illusions presented: <a class="scroll-to" href="#flippy_illusions">Flippy Illusions</a>,
		<a class="scroll-to" href="#rotating_overlays">Rotating Overlays</a>, and
		<a class="scroll-to" href="#hidden_characters">Hidden Characters</a>
	</p>

	<!-- <ol>
		  <li><a class="scroll-to" href="#flippy_illusions">Flippy Illusions</a></li>
	  <li><a class="scroll-to" href="#rotating_overlays">Rotating Overlays</a></li>
	  <li><a class="scroll-to" href="#hidden_characters">Hidden Characters</a></li>
	</ol> -->



	<h2 id="flippy_illusions">Flippy Illusions</h2>
	<p>If you wait a few seconds, the below images will flip upside-down - to reveal a new image!

		<span class="no_mobile">
			You can <it><b>click and drag</b></it> an image to rotate it by yourself, and <b>double click</b> to reset
			it.</span>
	</p>

	<br>
	<div style="text-align: center;">
		<span class="reset-all-flip-images-button no_mobile" style="margin-right:30px">
			<b>Click here to reset all rotations</b>
		</span>
		<span class="generic_pause_button flippy_pause_button" style="display: inline-block; width: 40pt;">
			<b>Pause</b>
		</span>
	</div>
	<br>
	<div class="col">
		<div class="row">
			<div class="image-container">
				<div class="caption">Angelic Pretty</div>
				<img src="images/flippers/angel.png" class="flip_image flip_image_animated glow-hover-element">
			</div>
			<div class="image-container">
				<div class="caption">A Bunny in a Bomber-Jacket</div>
				<img src="images/flippers/bunnybomber.jpeg" class="flip_image flip_image_animated glow-hover-element">
			</div>
			<div class="image-container">
				<div class="caption">Victorian Dress</div>
				<img src="images/flippers/lolo2.png" class="flip_image flip_image_animated glow-hover-element">
			</div>
		</div>
		<div class="row">
			<div class="image-container">
				<div class="caption">A boat</div>
				<img src="images/flippers/boatboat.png" class="flip_image flip_image_animated glow-hover-element">
			</div>
			<div class="image-container">
				<div class="caption">Giraffe / Penguin</div>
				<img src="images/flippers/giraffepenguin.png" class="flip_image flip_image_animated glow-hover-element">
			</div>
			<div class="image-container">
				<div class="caption">Bubble Fairy</div>
				<img src="images/flippers/bubblefairy.png" class="flip_image flip_image_animated glow-hover-element">
			</div>
		</div>
		<div class="row">
			<div class="image-container">
				<div class="caption">Dog / Elephant</div>
				<img src="images/flippers/dogephant.png" class="flip_image flip_image_animated glow-hover-element">
			</div>
			<div class="image-container">
				<div class="caption">Dog / Sloth</div>
				<img src="images/flippers/dogsloth.png" class="flip_image flip_image_animated glow-hover-element">
			</div>
			<div class="image-container">
				<div class="caption">Seagull / Bunny</div>
				<img src="images/flippers/bunnyduck.png" class="flip_image flip_image_animated glow-hover-element">
			</div>
		</div>
	</div>

	<h3>A real-life demo:</h3>
	<div style="text-align:center;">
		<iframe width="393.5" height="700"
			src="https://www.youtube.com/embed/hmV_J3p2KVo?autoplay=1&loop=1&playlist=hmV_J3p2KVo&rel=0"
			title="YouTube video player" frameborder="0"
			allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
			allowfullscreen></iframe>

	</div>
	<br>
	<a target="_blank"
		href="https://githubtocolab.com/RyannDaGreat/Diffusion-Illusions/blob/master/flippy_illusions_for_colab.ipynb">
		<h3><img src="images/colab_logo.svg" alt="Google Colab logo" width="30pt" height="30pt"
				style="vertical-align: middle; margin-right: 10pt;">Try it on Colab!</h3>
	</a>

	<hr>

	<h2 id="rotating_overlays">Rotating Overlays</h2>
	<p>In this section, we have examples with two images. As the one on the top is rotated, the image changes! The one
		on the top is multiplied by the one on the bottom
		(pixelwise), simulating how light would be filtered through two transparent sheets with images printed on them.
		Effectively, we've made 4 images out of 2!</p>
	<p>This works in real life too: you can overlay printouts of these images on top of each other for the same results,
		as seen in the youtube video.</p>
	<p>You can <it><b>click and drag</b></it> them to inspect the top and bottom images separately, or right
		click and open image in new tab to print them out for yourself. To reset the position of an image, <b> double
			click it.</b></p>



	</p>


	<br>
	<br>



	<div class="col">
		<div style="text-align: center;">
			<span class="reset-all-rotaters-button" style="margin-right:30px">
				<b>Click here to reset all positions</b>
			</span>
			<span class="generic_pause_button rotation_overlay_pause_button"
				style="display: inline-block; width: 40pt;">
				<b>Pause</b>
			</span>
		</div>
		<br>
		<br>

		<div class="row">

			<div class="rot-image-container" style="filter: brightness(200%);">
				<img src="images/rotaters/4girlb.png" class="rot_image_size">
				<img src="images/rotaters/4girlr.png"
					class="rot_image_size quad-rotating-image draggable-image glow-hover-element">
			</div>

			<div style="width: 50px"></div>

			<div class="rot-image-container" style="filter: brightness(200%);">
				<img src="images/rotaters/affatab.png" class="rot_image_size">
				<img src="images/rotaters/affatar.png"
					class="rot_image_size quad-rotating-image draggable-image glow-hover-element">
			</div>

			<div style="width: 50px"></div>

			<div class="rot-image-container">
				<img src="images/rotaters/mikupb.png" class="rot_image_size">
				<img src="images/rotaters/mikupr.png"
					class="rot_image_size quad-rotating-image draggable-image glow-hover-element">
			</div>

		</div>

		<br>
		<br>

		<div class="row">
			<!-- <div class="rot-image-container" style="filter: brightness(150%);">
				<img src="images/rotaters/rastb.png" class="rot_image_size">
				<img src="images/rotaters/rastr.png"
					class="rot_image_size quad-rotating-image draggable-image glow-hover-element">
			</div> -->
			<div class="rot-image-container" style="filter: brightness(150%);">
				<img src="images/rotaters/lipb.png" class="rot_image_size">
				<img src="images/rotaters/lipr.png"
					class="rot_image_size quad-rotating-image draggable-image glow-hover-element">
			</div>
			<div style="width: 50px"></div>
			<div class="rot-image-container" style="filter: brightness(150%);">
				<img src="images/rotaters/asasab.png" class="rot_image_size">
				<img src="images/rotaters/asasar.png"
					class="rot_image_size quad-rotating-image draggable-image glow-hover-element">
			</div>
			<div style="width: 50px"></div>
			<div class="rot-image-container" style="filter: brightness(150%);">
				<img src="images/rotaters/dollopb.png" class="rot_image_size">
				<img src="images/rotaters/dollopr.png"
					class="rot_image_size quad-rotating-image draggable-image glow-hover-element">
			</div>
		</div>

		<br>
		<br>

		<div class="row">

			<div class="rot-image-container">
				<img src="images/rotaters/dolfob.png" class="rot_image_size">
				<img src="images/rotaters/dolfor.png"
					class="rot_image_size quad-rotating-image draggable-image glow-hover-element">
			</div>

			<div style="width: 50px"></div>

			<div class="rot-image-container" style="filter: brightness(200%);">
				<img src="images/rotaters/pikavaderb.png">
				<img src="images/rotaters/pikavaderr.png"
					class="quad-rotating-image draggable-image glow-hover-element">
			</div>

			<div style="width: 50px"></div>


			<div class="rot-image-container" style="filter: brightness(150%);">
				<img src="images/rotaters/cowerr.png" class="rot_image_size">
				<img src="images/rotaters/cowerb.png"
					class="rot_image_size quad-rotating-image draggable-image glow-hover-element">
			</div>
		</div>

		<br>
		<br>

		<div class="row">
			<div class="rot-image-container" style="filter: brightness(170%);">
				<img src="images/rotaters/seasonb.png">
				<img src="images/rotaters/seasonr.png" class="season-rotating-image draggable-image glow-hover-element">
			</div>
			<div style="width: 50px"></div>
			<div class="rot-image-container" style="filter: brightness(180%);">
				<img src="images/rotaters/rotablenderb.png">
				<img src="images/rotaters/rotablenderr.png"
					class="elf-rotating-image draggable-image glow-hover-element">
			</div>
			<div style="width: 50px"></div>
			<div class="rot-image-container" style="filter: brightness(150%);">
				<img src="images/rotaters/skellyb.png">
				<img src="images/rotaters/skellyr.png" class="skelly-rotating-image draggable-image glow-hover-element">
			</div>
		</div>

		<br>
		<br>

		<div class="row">
			<div class="rot-image-container" style="filter: brightness(170%);">
				<img src="images/rotaters/discor.png">
				<img src="images/rotaters/discob.png" class="quad-rotating-image draggable-image glow-hover-element">
			</div>
			<div style="width: 50px"></div>
			<div class="rot-image-container" style="filter: brightness(180%);">
				<img src="images/rotaters/tardyb.png">
				<img src="images/rotaters/tardyr.png" class="quad-rotating-image draggable-image glow-hover-element">
			</div>
			<div style="width: 50px"></div>
			<div class="rot-image-container" style="filter: brightness(180%);">
				<img src="images/rotaters/bbadb.png">
				<img src="images/rotaters/bbadr.png" class="quad-rotating-image draggable-image glow-hover-element">
			</div>
			<!-- <div style="width: 50px"></div>
			<div class="rot-image-container" style="filter: brightness(150%);">
				<img src="images/rotaters/skellyb.png">
				<img src="images/rotaters/skellyr.png" class="skelly-rotating-image draggable-image glow-hover-element">
			</div> -->
		</div>



	</div>

	<br>
	<br>

	<h3>A real-life demo:</h3>
	<div style="text-align:center;">
		<!-- <iframe width="560" height="315" src="https://www.youtube-nocookie.com/embed/NWEUaXHWyI0"
			title="YouTube video player" frameborder="0"
			allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
			allowfullscreen></iframe> -->
		<iframe width="700" height="393.75" src="https://www.youtube.com/embed/CWXMSHKrd8Y?rel=0"
			title="YouTube video player" frameborder="0"
			allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
			allowfullscreen></iframe>
	</div>
	<div class="caption">
		<a target="_blank" href="assets/rotating_overlays.pdf">Click here for a printable PDF</a> full of these images,
		so you can try
		it yourself!
	</div>

	<a target="_blank"
		href="https://githubtocolab.com/RyannDaGreat/Diffusion-Illusions/blob/master/rotation_overlays_for_colab.ipynb">
		<h3><img src="images/colab_logo.svg" alt="Google Colab logo" width="30pt" height="30pt"
				style="vertical-align: middle; margin-right: 10pt;">Try it on Colab!</h3>
	</a>


	<hr>
	<h2 id="hidden_characters">Hidden Characters</h2>
	<p>In this section, we have sets of 4 images. You can <it><b>click and drag</b></it> them on top of each other! They
		will all be
		multiplied together, and when they're all on top of each other they will reveal a secret 5th image. To reset the
		position of an image, <b> double click it.</b></p>
	</p>

	<!-- <button type="button" . class="">Click me</button> -->


	<p>This works in real life too: you can overlay printouts of these images on top of each other for the same results,
		as seen in the youtube video.</p>
	</p>
	<p>I won't spoil it for you in this paragraph; try it out!</p>

	<br>
	<br>
	<div style="text-align: center;">
		<span class="reset-all-hidden-characters-button">
			<b>Click here to reset all positions</b>
		</span>
	</div>
	<br>
	<br>


	<div>
		<div class="row lightbox">
			<div class="hidden-character-image-container"><img src="images/quad_overlays/tanky0.png"
					class="draggable-image quad-overlay glow-hover-element wiggly-image hidden-character-image"></div>
			<div class="hidden-character-image-container"><img src="images/quad_overlays/tanky1.png"
					class="draggable-image quad-overlay glow-hover-element wiggly-image hidden-character-image"></div>
			<div class="hidden-character-image-container"><img src="images/quad_overlays/tanky2.png"
					class="draggable-image quad-overlay glow-hover-element wiggly-image hidden-character-image"></div>
			<div class="hidden-character-image-container"><img src="images/quad_overlays/tanky3.png"
					class="draggable-image quad-overlay glow-hover-element wiggly-image hidden-character-image"></div>
		</div>
		<div class="caption">Click and drag these 4 pictures together! Can you find the hidden 5th picture? <br>

			<span class="smaller-text">(hint:
				it's easiest to see on the white background!)</span>
		</div>
	</div>

	<br>
	<br>
	<br>
	<br>



	<div>
		<div class="row lightbox">
			<div class="hidden-character-image-container"><img src="images/quad_overlays/darthy00.png"
					class="draggable-image quad-overlay glow-hover-element wiggly-image hidden-character-image"></div>
			<div class="hidden-character-image-container"><img src="images/quad_overlays/darthy01.png"
					class="draggable-image quad-overlay glow-hover-element wiggly-image hidden-character-image"></div>
			<div class="hidden-character-image-container"><img src="images/quad_overlays/darthy02.png"
					class="draggable-image quad-overlay glow-hover-element wiggly-image hidden-character-image"></div>
			<div class="hidden-character-image-container"><img src="images/quad_overlays/darthy03.png"
					class="draggable-image quad-overlay glow-hover-element wiggly-image hidden-character-image"></div>
		</div>
		<div class="caption">Try it with these too!</div>

	</div>


	<br>
	<br>
	<br>
	<br>


	<!-- Javascript Goes Here -->
	<script src="https://code.jquery.com/jquery-3.6.0.js"></script>
	<script src="https://code.jquery.com/ui/1.13.2/jquery-ui.js"></script>
	<script
		src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui-touch-punch/0.2.3/jquery.ui.touch-punch.min.js"></script>
	<script>
		$(function () {
			function storeOriginalPositions() {
				// Iterate through each draggable image and store its original position
				$('.draggable-image').each(function () {
					$(this).data('originalPosition', $(this).position());
				});

				// Define the CSS rules as a string
				//Add animations AFTER getting the position so we don't corrupt the positions
				const cssRules = `
		.quad-rotating-image {
			animation: quad_rotate 12s linear infinite;
		}
		.season-rotating-image {
			animation: season_rotate 6s linear infinite;
		}
		.skelly-rotating-image {
			animation: skelly_rotate 9s linear infinite;
		}
		.elf-rotating-image {
			animation: elf_rotate 9s linear infinite;
		}
	`;

				// Create a <style> element
				const styleElement = document.createElement('style');
				styleElement.type = 'text/css';

				// Add the CSS rules to the <style> element
				styleElement.appendChild(document.createTextNode(cssRules));

				// Insert the <style> element with the new CSS rules into the <head> of the document
				document.head.appendChild(styleElement);
			}


			function makeImagesDraggable() {
				$('.draggable-image').draggable({
					snap: '.hidden-character-image, .lightbox',
					start: function () {
						if ($(this).hasClass('wiggly-image')) {
							stop_wiggle = true;
						}
					},
					drag: function (event, ui) {
						var transformMatrix = $(this).css('transform');
						ui.helper.css('transform', transformMatrix);
						$('.reset-all-rotaters-button, .reset-all-hidden-characters-button').removeClass('inactive_button');
					},
					stop: function () {
						$('.reset-all-rotaters-button, .reset-all-hidden-characters-button').removeClass('inactive_button');
					}
				}).dblclick(function () {
					var originalPosition = $(this).data('originalPosition');
					$(this).animate({
						top: originalPosition.top,
						left: originalPosition.left
					}, 1000);
				});
			}

			function resetRotatersPositions() {
				$('.reset-all-rotaters-button').click(function () {
					function func() {
						var originalPosition = $(this).data('originalPosition');
						$(this).animate({
							top: originalPosition.top,
							left: originalPosition.left
						}, 1000);
					}
					$('.quad-rotating-image').each(func);
					$('.season-rotating-image').each(func);
					$('.skelly-rotating-image').each(func);
					$('.elf-rotating-image').each(func);
					$(this).addClass('inactive_button')
					// setButtonsInactive();
				});
			}

			function resetHiddenCharactersPositions() {
				$('.reset-all-hidden-characters-button').click(function () {
					$('.hidden-character-image').each(function () {
						var originalPosition = $(this).data('originalPosition');
						$(this).animate({
							top: originalPosition.top,
							left: originalPosition.left
						}, 1000);
					});
					// setButtonsInactive();
					$(this).addClass('inactive_button')
				});
			}

			function resetFlipImagesPositions() {
				$('.reset-all-flip-images-button').click(function () {
					$('.flip_image').each(function () {
						var originalPosition = $(this).data('originalPosition');

						$(this).removeClass('flip_image_animated');
						$(this).css({
							'transform': 'rotateZ(0deg)',
							'transition': 'transform 1s'
						});

						setTimeout(() => {
							$(this).css('transition', ''); // Clear the transition property
							$(this).addClass('flip_image_animated');
						}, 1000); // Wait for the 1-second animation to finish before adding the class
					});

					$(this).addClass('inactive_button');
				});
			}

			function startWiggle(intervalTime) {
				setInterval(function () {
					if (stop_wiggle) {
						return;
					}

					var images = $('.wiggly-image');
					var randomIndex = Math.floor(Math.random() * images.length);
					var randomImage = images.eq(randomIndex);

					if (Math.random() > .5) {
						randomImage.css('animation', 'wiggle .5s');
						randomImage.one('animationend', function () {
							randomImage.css('animation', '');
						});
					}
				}, 500);
			}

			function makeImagesZoomable() {
				$(".image-container img").wrap(function () {
					return $("<a>", {
						href: this.src,
						target: "_blank"
					});
				});
			}

			function smoothScrolling() {
				$('.scroll-to').click(function () {
					$('html, body').animate({
						scrollTop: $($(this).attr('href')).offset().top
					}, 500);

					return false;
				});
			}

			var stop_wiggle = false;


			function setButtonsInactive() {
				$('.reset-all-rotaters-button, .reset-all-hidden-characters-button, .reset-all-flip-images-button').addClass('inactive_button');
			}

			function initFlipImageRotation() {
				var dragging = false;
				var currentElement;
				var centerX;
				var centerY;
				var initialAngle;
				var currentRotation;

				function getCurrentRotation(elem) {
					var matrix = elem.css('transform');
					var angle;

					if (matrix !== 'none') {
						var values = matrix.split('(')[1].split(')')[0].split(',');
						var a = values[0];
						var b = values[1];
						angle = Math.atan2(b, a) * (180 / Math.PI);
					} else {
						angle = 0;
					}

					return angle;
				}

				$('.flip_image').mousedown(function (e) {
					$('.reset-all-flip-images-button').removeClass('inactive_button');
					dragging = true;
					currentElement = $(this);
					centerX = currentElement.offset().left + (currentElement.width() / 2);
					centerY = currentElement.offset().top + (currentElement.height() / 2);
					var mouseX = e.pageX;
					var mouseY = e.pageY;
					initialAngle = Math.atan2(mouseX -
						centerY, mouseY - centerY);
					currentRotation = getCurrentRotation(currentElement);
					currentElement.css('cursor', 'grabbing'); // closed hand cursor while dragging
					currentElement.removeClass('flip_image_animated'); // remove the animated class when clicked or dragged
				});

				$('.flip_image').dblclick(function () {
					$(this).addClass('flip_image_animated'); // add the animated class when double-clicked
				});

				$(document).mouseup(function () {
					if (dragging && currentElement) {
						currentElement.css('cursor', 'grab'); // open hand cursor after dragging
					}
					dragging = false;
				});

				$(document).mousemove(function (e) {
					if (dragging && currentElement) {
						var mouseX = e.pageX;
						var mouseY = e.pageY;
						var currentAngle = Math.atan2(mouseX - centerX, mouseY - centerY);
						var deltaAngle = initialAngle - currentAngle;
						var newRotation = currentRotation + (deltaAngle * (180 / Math.PI));
						currentElement.css('transform', 'rotate(' + newRotation + 'deg)');
						currentElement.css('transform-origin', '50% 50%');
					}
				});
			}

			// Initialize functions
			storeOriginalPositions();
			makeImagesDraggable();
			resetRotatersPositions();
			resetHiddenCharactersPositions();
			resetFlipImagesPositions();
			setButtonsInactive();
			smoothScrolling();
			startWiggle();
			// initFlipImageRotation();





		});



		(function () {
			var dragging = false;
			var currentElement;
			var centerX;
			var centerY;
			var initialAngle;
			var currentRotation;

			function getCurrentRotation(elem) {
				var matrix = elem.css('transform');
				var angle;

				if (matrix !== 'none') {
					var values = matrix.split('(')[1].split(')')[0].split(',');
					var a = values[0];
					var b = values[1];
					angle = Math.atan2(b, a) * (180 / Math.PI);
				} else {
					angle = 0;
				}

				return angle;
			}

			$(function () {
				$('.flip_image').mousedown(function (e) {
					$('.reset-all-flip-images-button').removeClass('inactive_button');
					dragging = true;
					currentElement = $(this);
					centerX = currentElement.offset().left + (currentElement.width() / 2);
					centerY = currentElement.offset().top + (currentElement.height() / 2);
					var mouseX = e.pageX;
					var mouseY = e.pageY;
					initialAngle = Math.atan2(mouseX - centerX, mouseY - centerY);
					currentRotation = getCurrentRotation(currentElement);
					currentElement.css('cursor', 'grabbing'); // closed hand cursor while dragging
					currentElement.removeClass('flip_image_animated'); // remove the animated class when clicked or dragged
					if (dragging && currentElement) {
						//Copied from mousemove; lets us catch it mid-spin without glitching
						var mouseX = e.pageX;
						var mouseY = e.pageY;
						var currentAngle = Math.atan2(mouseX - centerX, mouseY - centerY);
						var deltaAngle = initialAngle - currentAngle;
						var newRotation = currentRotation + (deltaAngle * (180 / Math.PI)); // add the new angle instead of subtracting it
						currentElement.css('transform', 'rotate(' + newRotation + 'deg)');
						currentElement.css('transform-origin', '50% 50%');
					}
				});

				$('.flip_image').dblclick(function () {
					$(this).addClass('flip_image_animated'); // add the animated class when double-clicked
				});

				$(document).mouseup(function () {
					if (dragging && currentElement) {
						currentElement.css('cursor', 'grab'); // open hand cursor after dragging
					}
					dragging = false;
				});

				$(document).mousemove(function (e) {
					if (dragging && currentElement) {
						var mouseX = e.pageX;
						var mouseY = e.pageY;
						var currentAngle = Math.atan2(mouseX - centerX, mouseY - centerY);
						var deltaAngle = initialAngle - currentAngle;
						var newRotation = currentRotation + (deltaAngle * (180 / Math.PI)); // add the new angle instead of subtracting it
						currentElement.css('transform', 'rotate(' + newRotation + 'deg)');
						currentElement.css('transform-origin', '50% 50%');
					}
				});
			});
		})();


		function isMobileDevice() {
			var userAgent = navigator.userAgent || navigator.vendor || window.opera;
			return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(userAgent);
		}
		$(document).ready(function () {
			if (isMobileDevice()) {
				$('.no_mobile').css('display', 'none');
			}
		});

		//Bibtex section
		$(document).ready(function () {
			var today = new Date();
			var yyyy = today.getFullYear();
			var mm = String(today.getMonth() + 1).padStart(2, "0");
			var dd = String(today.getDate()).padStart(2, "0");
			var currentDate = `${yyyy}-${mm}-${dd}`;

			var citation = `@misc{diffusion_illusions,
    title = {Diffusion Illusions: Hiding Images in Plain Sight},
    author = {Burgert, Ryan and Ranasinghe, Kanchana and Li, Xiang and Ryoo, Michael},
    year = {2023},
    month = mar,
    howpublished = {\\url{https://ryanndagreat.github.io/Diffusion-Illusions}},
    note = {Accessed: ${currentDate}}
}`;

			$("#citation-text").text(citation);
		});


		//Play and Pause Buttons
		$(document).ready(function () {
			$('.rotation_overlay_pause_button').data('state', 'pause').on('click', function () {
				var button = $(this);
				var currentState = button.data('state');

				if (currentState === 'pause') {
					button.data('state', 'play');
					button.html('<b>Play</b>'); // Replace this with your image code when needed
					// $('.quad-rotating-image, .season-rotating-image, .skelly-rotating-image, .elf-rotating-image').addClass('paused');
					$('.quad-rotating-image, .season-rotating-image, .skelly-rotating-image, .elf-rotating-image').css('animation-play-state', 'paused');

				} else if (currentState === 'play') {
					button.data('state', 'pause');
					button.html('<b>Pause</b>'); // Replace this with your image code when needed
					// $('.quad-rotating-image, .season-rotating-image, .skelly-rotating-image, .elf-rotating-image').removeClass('paused');
					$('.quad-rotating-image, .season-rotating-image, .skelly-rotating-image, .elf-rotating-image').css('animation-play-state', 'unset');
				}
			});
		});

		$(document).ready(function () {
			//TODO: Why doesn't this work?
			$('.flippy_pause_button').data('state', 'pause').on('click', function () {
				var button = $(this);
				var currentState = button.data('state');

				if (currentState === 'pause') {
					button.data('state', 'play');
					button.html('<b>Play</b>'); // Replace this with your image code when needed
					// $('flip_image, flip_image_animated').addClass('paused');
					$('.flip_image').css('animation-play-state', 'paused');

				} else if (currentState === 'play') {

					button.data('state', 'pause');
					button.html('<b>Pause</b>'); // Replace this with your image code when needed
					// $('flip_image, flip_image_animated').removeClass('paused');
					$('.flip_image').css('animation-play-state', 'unset');
				}

			});

		});




	</script>


	<h3>A real-life demo <span style="color: ;">[WARNING: SPOILERS!!!]</span></h3>
	<div style="text-align:center;">
		<iframe width="700" height="393.5" src="https://www.youtube.com/embed/dt612_cpYl0?rel=0"
			title="YouTube video player" frameborder="0"
			allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
			allowfullscreen></iframe>
	</div>

	<br>
	<a target="_blank"
		href="https://githubtocolab.com/RyannDaGreat/Diffusion-Illusions/blob/master/hidden_characters_for_colab.ipynb">
		<h3><img src="images/colab_logo.svg" alt="Google Colab logo" width="30pt" height="30pt"
				style="vertical-align: middle; margin-right: 10pt;">Try it on Colab!</h3>
	</a>


	<hr>

	<h2 id="summary">CVPR Demo Proposal Summary</h2>

	<h3>Project Overview</h3>
	<p>The project is comprised of three demonstrations:</p>
	<ol>
		<li><strong>Generating images that appear as different objects when flipped upside down</strong> - For example,
			a giraffe could look like a penguin. <br>
			Top accomplish this, let's define some functions and variables. We want to create an image "Image" such that
			when viewed right side up, "Image" matches "Prompt1" (in this case 'Giraffe'). And when Image is upside
			down, we want it to match the prompt "Penguin"
			We optimize an image we'll call "Image" using score distillation loss "SD". We optimize SD(Image,prompt_1)
		</li>
		<li><strong>Revealing a hidden image through image overlay</strong> - Overlaying four images, such as Hatsune
			Miku, a bear in a field, Mario, and a pumpkin, to reveal a fifth image, Darth Vader, when light is shone
			behind it. The four images are optimized to look like the original objects when viewed individually, but
			when combined, they reveal the hidden image of Darth Vader.</li>
		<li><strong>Revealing multiple images through image rotation</strong> - Overlaying two images to reveal four
			different images when rotated. The top image, when overlayed on the bottom image and light shines through,
			will reveal an image such as Darth Vader. When the top image is rotated 90 degrees, it becomes a different
			picture such as Pikachu. Another 90-degree rotation reveals another image and a final 90-degree rotation
			reveals a fourth image.</li>
	</ol>

	<h3>Interactive Experience</h3>
	<p>The project will include physical items such as transparencies for people to interact with, as well as a live
		demonstration that will allow people to create their own illusions on the spot. If space permits, we might bring
		a printer to let people play with the illusions they create. And if we have even more space, perhaps a robot arm
		to automatically demo the flippy images.</p>

	<p>In this website you'll find multiple interactive exhibits where you can drag images around as if they were pieces
		of paper / transparencies. Until we demo at CVPR, this is the next best thing to the physical demo! </p>

	<h3>Similar Projects</h3>
	<p>Another project with a similar goal was released in February: <a target="_blank"
			href="https://github.com/tancik/Illusion-Diffusion">Illusion-Diffusion</a>, authored by Matthew Tanick. That
		project only achieves the first part of this demo, aka image flipping.</p>

	<p>Our paper, <a href="https://ryanndagreat.github.io/peekaboo/">"Peekaboo: Text to Image Diffusion
			Models are Zero Shot Segmentors"</a>, has an extremely similar formulation to the illusions on this website
		- it optimizes images using a variant of score distillation loss to perform zero shot segmentation.</p>


	<h3>Pseudocode</h3>
	<p>To help explain how these were calculated, I've included some easy-to-read pseudocode that covers how each of
		these illusions were made. The full source code can be found at <a target="_blank"
			href="https://github.com/RyannDaGreat/Diffusion-Illusions">github.com/RyannDaGreat/Diffusion-Illusions</a>,
		or at any of the Google Colab links throughout this webpage.</p>
	<h4>Flippy Illusions</h4>
	<script src="https://gist.github.com/RyannDaGreat/fde3d6c05fb4d6d0cf31e7477658d3fd.js"></script>
	<br>
	<h4>Rotating Overlays</h4>
	<script src="https://gist.github.com/RyannDaGreat/0cb428a7d0a839249f058ef8273b9faf.js"></script>
	<br>
	<h4>Hidden Characters</h4>
	<script src="https://gist.github.com/RyannDaGreat/9dc5d591ec7bbba3743eab69e964b8db.js"></script>

	<h3>Timelapses</h3>

	<p>Diffusion illisions are generated through an iterative process: we optimize the output images with gradient
		descent, starting from pure noise. Here are some timelapses showing how they evolve over time.</p>

	<h4>Flippy Illusion Timelapses</h4>
	<div style="text-align:center;">
		<iframe width="700" height="700"
			src="https://www.youtube.com/embed/YRWd4nVcZlA?autoplay=1&loop=1&playlist=YRWd4nVcZlA&rel=0"
			title="YouTube video player" frameborder="0"
			allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
			allowfullscreen></iframe>
	</div>
	<p class="center_text">For reference, here are the end results of the above timelapse video:</p>
	<div style="text-align: center;" class="no_mobile">
		<span class="reset-all-flip-images-button" style="margin-right:30px">
			<b>Click here to reset all rotations</b>
		</span>
		<span class="generic_pause_button flippy_pause_button" style="display: inline-block; width: 40pt;">
			<b>Pause</b>
		</span>
	</div>
	<br>
	<div class="col">
		<div class="row">
			<div class="image-container">
				<div class="caption">Giraffe / Penguin</div>
				<img src="images/flippers/giraffepenguin_timelapse.png"
					class="flip_image flip_image_animated glow-hover-element">
			</div>
			<div class="image-container">

				<div class="caption">Angelic Pretty / Victorian Dress</div>
				<img src="images/flippers/lolo_timelapse.png" class="flip_image flip_image_animated glow-hover-element">
			</div>
		</div>

	</div>
	<br>
	<br>
	<br>
	<h3>Bibtex Citation</h3>
	<div class="citation-box">
		<pre id="citation-text"></pre>
	</div>
	<br>

</body>

</html>